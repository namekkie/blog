---
title: "「コンピュータシステムの理論と実装」を読んだ"
createdAt: "2024-07-15"
category:
  - "低レイヤー"
  - "読書メモ"
---

# なぜ読もうと思ったか

実はこの本の購入は２度目で１度目は４年ほど前の修士１年のとき。そのときは「コンピュータ」ってものがブラックボックスすぎて少しでも動作を理解したいという思いから読み始めてみたものの、なかなかのボリューム感や難易度に継続できず、５章くらいま読んで挫折しメルカリで売ってしまいました。

今回も動機としては、「低レイヤーを知りたい」といった感じで、最近は仕事でわからない部分は結局低レイヤーの知識が不足しているからなのでは？といった思いがふつふつと湧いてきてそんなときにこの本の存在を思い出したので、前回読んだときよりは知識も経験もあるのでもう少し苦労せずに読めるのではと再度購入してみました。

# 良かったところ

当初の目的であった低レイヤーについての理解を深めることに関しては十分に達成できたと感じてます。

特に 5 章までのハードウェアのセクションはとても面白くどんな風にコンピュータが作られているのかがかなりイメージ出来ました。

ただ 7 章以降はかなり難しく理解が出来ていない部分&実装できていない部分も多いため、時間を置いて再度読み直したいと思います。

# まだ分からなかったこと

コンパイラと OS については別途勉強が必要と感じた。

またコードを書く力がシンプルに足りていないことも痛感した。

# メモ

## 1 章　ブール理論

Nand を使って Not, OR, AND を作り、さらにそれらを使って Xor, Mux, DMux を作り、さらに今まで作ったもの入力や出力が n ビットに対応したものを作った。

特に Mux と DMux が難しく苦戦した。

現段階では回路を作っただけで全体像が見えないが、これがどうなっていくのかがすごく楽しみ。

## 2 章　ブール算術

ALU を作った。そこまで苦戦せず。

## 3 章　順序回路

ついにレジスタとメモリを作る。

データの保持と書き換えはこうやって行われてるのかと基本的な仕組みが見えて面白かった。

## 4 章　機械語

アセンブリ言語を使って’Mult.asm

## 5 章　コンピュータアーキテクチャ

ついにハードウェアの集大成。

レジスタは CPU の近くにいてメモリは遠くにいるから読み書きの速度が異なるみたいな説明をよく本で読んでたけど実際に作ってみてそもそもレジスタは CPU 内にあるってことを理解できた。

プログラム内臓方式

メモリにデータだけでなく、コンピュータが実行する命令も格納する。

それぞれデータメモリと命令メモリに格納される。

## 6 章　アセンブラ

アセンブリを 0,1 の機械語に変換する作業とか全く検討もついてなかったけど、実際にはそこまで高度なことはしてなくて、シンボルの処理とか若干ややこいとこもあるけど、パターンごとに決められた形があって、それに合わせて変換してくだけ。

５章とあわせて CPU が変わると機械語が変わるからコンパイルが必要ってのも理解できた。

## 7 章　バーチャルマシン#1：スタック操作

この章からコンパイラを作っていく。コンパイラは高級言語を中間言語に変換するフロントエンドと中間言語をアセンブリに変換するバックエンドに分けられる。

中間言語に変換する理由はハードウェアが異なる環境でコンパイルする際に、ソースコードを変換せずに、バックエンド部分だけを変更すればいいことと、様々な高級言語をコンパイルする際にバックエンドを使いまわせることが上げられる。

この中間言語を実行するためにはバーチャルマシンと呼ばれるソフトを作成する必要がある。

バーチャルマシンにはスタックが利用される。

スタックは IPA の試験で構造自体は理解していたけど、どこでどんな風に利用されるとかは知らなかったのでよかった。

## 8 章　バーチャルマシン#2：プログラム制御

関数の呼び出しにもスタックが利用される。

引数 → リターンアドレス → ローカル変数の順にスタックにプッシュされる。

リターン後は引数までスタックから取り除かれ戻り値が最上位に格納される。

## 9 章　高水準言語

Jack 言語を実装する。

## 10 章,11 章コンパイラ（構文解析、コード生成）

10,11 章はコンパイラのフロントエンドを作成する。

構文解析とはプログラムがどこから始まってどこで終わり、なにをしているのかといったプログラムの構造を理解すること。

機能としてはトークナイザとパーサに分けられる。

まずトークナイザでプログラムを if とか(とか最小単位に分割する。これをトークンと言う。

その後パーサでトークンを意味のある構造にグループ化する。

## 12 章　オペレーティングシステム

Todo

## 13 章　さらに次へ

Todo
